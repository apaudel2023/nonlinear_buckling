clc; clear all; close all;
format long e
%%  SCALING FACTOR
SF_LB = 1E-2; % Pa
SF_UB = 0.2;
SF_MEAN = (SF_LB+SF_UB)/2;
SF_PDF = 1/(SF_UB-SF_LB);
%%   MATERIAL PROPERTIES: RANDOM INPUT PROPERTIES : Transversely Isoptropic
E11 = 123550; % MPa
E22 = 8708;
v12 = 0.319;
G12 = 5695;
tply   = 1.25E-1*ones(1,10); % mm
ortply = [60 -60 0 0 68 -68 52 -52 37 -37]; % degree
MEANPOOL_SFMAX_1E1_25D = [E11 E22 v12 G12 tply ortply SF_MEAN];
%%
save('MEANPOOL_SFMAX_1E1_25D.mat','MEANPOOL_SFMAX_1E1_25D') % SAVE MEAN POOL MAT FILE
%% BASIS RANDOM VARIABLES SAMPLES FOR MCS/SOBOL
sample_size = 5E4;
varnum = length(MEANPOOL_SFMAX_1E1_25D);
PSOBOLSET  = sobolset(varnum,'Skip',1e3,'Leap',1e2);
BASIS_SAMP = net(PSOBOLSET,sample_size); % U[0,1]
%% USING GAUSSIN RANDOM VARIABLES
COV = 0.05;
samp_mprop = icdf('normal',BASIS_SAMP(:,1:4),   MEANPOOL_SFMAX_1E1_25D(:,1:4),  COV*(MEANPOOL_SFMAX_1E1_25D(:,1:4)));
samp_tply  = icdf('normal',BASIS_SAMP(:,5:14),  MEANPOOL_SFMAX_1E1_25D(:,5:14), COV*(MEANPOOL_SFMAX_1E1_25D(:,5:14)));
samp_tang  = icdf('normal',BASIS_SAMP(:,15:24), MEANPOOL_SFMAX_1E1_25D(:,15:24),5*ones(1,length(ortply))); % 5 degrees of std for ply orientation
samp_sf  = SF_LB + (SF_UB-SF_LB)*BASIS_SAMP(:,25);
%% BASIS SAMP STANDARD 
BSAMP_STANDARD_1_24 = icdf('normal',BASIS_SAMP(:,1:24),0,1);
BSAMP_STANDARD_25 = icdf('uniform',BASIS_SAMP(:,25),-1,1);
BSAMP_STANDARD = [BSAMP_STANDARD_1_24 BSAMP_STANDARD_25];

%% USING UNIFROM RANDOM VARIABLES FOR SCALING FACTOR
SAMPBANK_SFMAX_2E1_1E2_25D.MEANPOOL = MEANPOOL_SFMAX_1E1_25D;
SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP = BSAMP_STANDARD;
SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP =[ samp_mprop samp_tply samp_tang samp_sf];

save('SAMPBANK_SFMAX_2E1_1E2_25D.mat', 'SAMPBANK_SFMAX_2E1_1E2_25D')


%%

stats_checkBasis = [[mean(SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,1:24))'; min(SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,25))]...
     [std(SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,1:24))'; max(SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,25))]]


stats_checkOrg = [[mean(SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,1:24))'; min(SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,25))]...
     [std(SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,1:24))'; max(SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,25))]]

%%

plot(1:length(SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,25)),SAMPBANK_SFMAX_2E1_1E2_25D.ORG_SAMP(:,25),'.')
plot(1:length(SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,25)),SAMPBANK_SFMAX_2E1_1E2_25D.BASIS_SAMP(:,25),'.')
